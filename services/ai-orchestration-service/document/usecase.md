# UseCase Diagram Processing Pipeline - Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             INPUT: UmlInput                             â”‚
â”‚  { id, typeUmlName, contentAssignment, solutionPlantUmlCode,            â”‚
â”‚    studentPlantUmlCode }                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               STEP 1: Domain Analysis (AI #1)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Prompt: uml-domain-extractor                                            â”‚
â”‚                                                                         â”‚
â”‚ INPUT:                                                                  â”‚
â”‚   â””â”€ contentAssignment                                                  â”‚
â”‚                                                                         â”‚
â”‚ OUTPUT:                                                                 â”‚
â”‚   â””â”€ DomainContext {                                                    â”‚
â”‚        â€¢ keywords[]                                                     â”‚
â”‚        â€¢ mandatoryRequirements[]                                        â”‚
â”‚        â€¢ scopeBoundaries                                                â”‚
â”‚      }                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              STEP 2: PlantUML Extract (AI #2)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Prompt: uml-plantuml-extractor                                          â”‚
â”‚                                                                         â”‚
â”‚ INPUT:                                                                  â”‚
â”‚   â”œâ”€ solutionPlantUmlCode                                               â”‚
â”‚   â”œâ”€ studentPlantUmlCode                                                â”‚
â”‚   â””â”€ domainContext                                                      â”‚
â”‚                                                                         â”‚
â”‚ OUTPUT:                                                                 â”‚
â”‚   â””â”€ DiagramJSON {                                                      â”‚
â”‚        solution: { actors[], usecases[], relationships{}, boundary{} }  â”‚
â”‚        student:  { actors[], usecases[], relationships{}, boundary{} }  â”‚
â”‚      }                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             STEP 3: Normalize Names (AI #3)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Prompt: uml-semantic-normalizer                                         â”‚
â”‚                                                                         â”‚
â”‚ INPUT:                                                                  â”‚
â”‚   â””â”€ Actor/UseCase names from both diagrams                             â”‚
â”‚                                                                         â”‚
â”‚ OUTPUT:                                                                 â”‚
â”‚   â””â”€ NormalizedDiagram {                                                â”‚
â”‚        solution: { actors[+normalized], usecases[+normalized], ... }    â”‚
â”‚        student:  { actors[+normalized], usecases[+normalized], ... }    â”‚
â”‚      }                                                                  â”‚
â”‚      normalized = { original, canonical, similarityScore }              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         STEP 4: Compare Structure (Rule-based - NO AI)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Pure TypeScript Logic                                                   â”‚
â”‚                                                                         â”‚
â”‚ INPUT:                                                                  â”‚
â”‚   â””â”€ NormalizedDiagram (solution + student)                             â”‚
â”‚                                                                         â”‚
â”‚ LOGIC:                                                                  â”‚
â”‚   â”œâ”€ Compare actors/usecases by canonical names                         â”‚
â”‚   â”‚  â†’ matched / missing / extra                                        â”‚
â”‚   â”œâ”€ Detect abstract parent pattern                                     â”‚
â”‚   â”‚  (isAbstractParent, childrenInStudent)                              â”‚
â”‚   â””â”€ Compare relationships                                              â”‚
â”‚      (actorToUC, include, extend, generalization)                       â”‚
â”‚                                                                         â”‚
â”‚ OUTPUT:                                                                 â”‚
â”‚   â””â”€ EnhancedComparisonResult {                                         â”‚
â”‚        actors: { matched[], missing[], extra[] }                        â”‚
â”‚        usecases: { matched[], missing[], extra[] }                      â”‚
â”‚        relationships: { actorToUC, include, extend, generalization }    â”‚
â”‚        missingActorsAnalysis: [{                                        â”‚
â”‚          actor, isAbstractParent, severity                              â”‚
â”‚        }]                                                               â”‚
â”‚      }                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          STEP 5: Classify + Score (AI #4 - HYBRID)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Prompt: uml-error-classifier-scorer                                     â”‚
â”‚                                                                         â”‚
â”‚ INPUT:                                                                  â”‚
â”‚   â”œâ”€ domainContext                                                      â”‚
â”‚   â”œâ”€ comparison                                                         â”‚
â”‚   â”œâ”€ normalized diagrams                                                â”‚
â”‚   â””â”€ scoringCriteria {                                                  â”‚
â”‚        actors: 20, usecases: 30,                                        â”‚
â”‚        relationships: 40, presentation: 10                              â”‚
â”‚      }                                                                  â”‚
â”‚                                                                         â”‚
â”‚ LOGIC:                                                                  â”‚
â”‚   â”œâ”€ AI analyzes comparison + domain context                            â”‚
â”‚   â”œâ”€ Classifies errors:                                                 â”‚
â”‚   â”‚  (UC-03-MISSING-PRIMARY, UC-03-MISSING-ABSTRACT-PARENT, ...)        â”‚
â”‚   â”œâ”€ Calculates context-aware penalties                                 â”‚
â”‚   â””â”€ Scores each category, applies penalties                            â”‚
â”‚                                                                         â”‚
â”‚ OUTPUT:                                                                 â”‚
â”‚   â””â”€ {                                                                  â”‚
â”‚        errors: [{                                                       â”‚
â”‚          code, severity, penalty, explanation, elements[], suggestion   â”‚
â”‚        }],                                                              â”‚
â”‚        score: {                                                         â”‚
â”‚          total,                                                         â”‚
â”‚          breakdown: { actors, usecases, relationships, presentation },  â”‚
â”‚          reasoning                                                      â”‚
â”‚        }                                                                â”‚
â”‚      }                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            STEP 6: Generate Feedback (AI #5)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Prompt: uml-feedback-generator                                          â”‚
â”‚                                                                         â”‚
â”‚ INPUT:                                                                  â”‚
â”‚   â”œâ”€ score                                                              â”‚
â”‚   â”œâ”€ errors                                                             â”‚
â”‚   â”œâ”€ comparison summary                                                 â”‚
â”‚   â””â”€ assignmentContext                                                  â”‚
â”‚                                                                         â”‚
â”‚ OUTPUT:                                                                 â”‚
â”‚   â””â”€ Markdown feedback string                                           â”‚
â”‚      "##    Use Case Diagram Evaluation                                 â”‚
â”‚       ##    Detected Errors                                             â”‚
â”‚       ##    Assessment                                                  â”‚
â”‚       ..."                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        OUTPUT: UmlProcessedResult                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ {                                                                       â”‚
â”‚   referenceScore: {                                                     â”‚
â”‚     total, breakdown, confidence, suggestedRange                        â”‚
â”‚   },                                                                    â”‚
â”‚   errors: [...],                                                        â”‚
â”‚   comparison: {                                                         â”‚
â”‚     actors, usecases, relationships                                     â”‚
â”‚   },                                                                    â”‚
â”‚   feedback: "markdown string",                                          â”‚
â”‚   humanReviewItems: [...],                                              â”‚
â”‚   metadata: {                                                           â”‚
â”‚     processingTime,                                                     â”‚
â”‚     aiCallsCount: 5,                                                    â”‚
â”‚     pipelineVersion,                                                    â”‚
â”‚     timestamp                                                           â”‚
â”‚   }                                                                     â”‚
â”‚ }                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Pipeline Summary

| Step | Type | AI Model | Purpose |
|------|------|----------|---------|
| **1** | ğŸ”µ AI | `uml-domain-extractor` | Extract domain knowledge from assignment |
| **2** | ğŸ”µ AI | `uml-plantuml-extractor` | Parse PlantUML code into JSON structure |
| **3** | ğŸ”µ AI | `uml-semantic-normalizer` | Normalize names for comparison |
| **4** | ğŸŸ¡ Rule | TypeScript Logic | Compare structures algorithmically |
| **5** | ğŸŸ£ Hybrid | `uml-error-classifier-scorer` | Classify errors & calculate scores |
| **6** | ğŸ”µ AI | `uml-feedback-generator` | Generate human-readable feedback |

## ğŸ”„ Data Flow

```
contentAssignment 
    â†“
DomainContext 
    â†“
DiagramJSON (solution + student)
    â†“
NormalizedDiagram
    â†“
EnhancedComparisonResult
    â†“
{ errors[], score{} }
    â†“
Markdown Feedback
    â†“
UmlProcessedResult
```

## ğŸ¯ Key Features

- **5 AI Calls**: Steps 1, 2, 3, 5, 6
- **1 Rule-based Step**: Step 4 (pure logic)
- **Scoring Criteria**: Actors (20), UseCases (30), Relationships (40), Presentation (10)
- **Error Codes**: UC-03-MISSING-PRIMARY, UC-03-MISSING-ABSTRACT-PARENT, etc.